{
  "hash": "fe9039a63f79e0bbbbb5198ff6d3ed57",
  "result": {
    "markdown": "---\nexecute:\n  message: false\n  warning: false\n  fig-show: no\ntitle: \"Gr치fico de barras horizontales con ggplot2 游游윺"\nauthor: \"FV\"\ndate: \"2024-06-02\"\ncategories: [code, analysis]\nimage: \"bar1.png\"\n---\n\n\nLos datos representan el 칈ndice de Desarrollo Humano en los diferentes distritos del Municipio de S칚o Paulo en el 2010.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# LIBRARIES\n{\nlibrary(ggplot2)\nlibrary(ggthemes)\nlibrary(dplyr)\nlibrary(readr)\nlibrary(sf)\nlibrary(showtext)\n}\n\n# FONTS\nfont_add_google(\"Luckiest Guy\",\"ramp\")\nfont_add_google(\"Bebas Neue\",\"beb\")\nfont_add_google(\"Fira Sans\",\"fira\")\nfont_add_google(\"Raleway\",\"ral\")\nfont_add_google(\"Bitter\",\"bit\")\nshowtext_auto()\n\n# DATA\ndata <- readr::read_rds(\n  \"https://github.com/viniciusoike/restateinsight/raw/main/static/data/atlas_sp_hdi.rds\"\n)\n\nHDI <- data |> \n  st_drop_geometry() |> \n  mutate(\n    group_hdi = findInterval(HDI, seq(0.65, 0.95, 0.05), left.open = FALSE),\n    group_hdi = factor(group_hdi)) |> \n  group_by(group_hdi) |> \n  summarise(score = sum(pop, na.rm = TRUE)) |> \n  ungroup() |> \n  mutate(share = score / sum(score) * 100) |> \n  na.omit()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(HDI, aes(group_hdi, share, fill = group_hdi)) +\n  geom_col()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nHDI <- HDI |> \n  mutate(\n    y_text = if_else(group_hdi %in% c(0, 7), share + 3, share - 3),\n    label = paste0(round(share, 1), \"%\")\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(HDI, aes(group_hdi, share, fill = group_hdi)) +\n  geom_col() +\n  geom_hline(yintercept = 0) +\n  geom_text(\n    aes(y = y_text, label = label, color = group_hdi),\n    size = 3\n  ) +\n  coord_flip() +\n  scale_fill_brewer(palette = \"YlGnBu\") +\n  scale_color_manual(values = c(rep(\"black\", 5), rep(\"white\", 2), \"black\")) +\n  guides(fill = \"none\", color = \"none\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nx_labels <- c(\n  \"Menos desarrollado\\n<0.650\", \"(0.650 - 0.699)\", \"(0.700 - 0.749)\", \"(0.750 - 0.799)\",\n  \"(0.800 - 0.849)\", \"(0.850 - 0.899)\", \"(0.900 - 0.949)\", \"M치s desarrollado\\n>0.950\"\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n ggplot(HDI, aes(group_hdi, share, fill = group_hdi)) +\n  geom_col() +\n  geom_hline(yintercept = 0) +\n  geom_text(\n    aes(y = y_text, label = label, color = group_hdi),\n    size = 4.5\n  ) +\n  coord_flip() +\n  scale_x_discrete(labels = x_labels) +\n  scale_fill_brewer(palette = \"YlGnBu\") +\n  scale_color_manual(values = c(rep(\"black\", 5), \n                                rep(\"white\", 2), \n                                \"black\")) +\n  guides(fill = \"none\", color = \"none\") +\n   labs(\n     title = \"\\n칈ndice de Desarrollo Humano\\nS칚o Paulo, Brasil\\n\",\n     caption = \"Poblaci칩n total: 11.209.673 hab.\\nDatos: Atlas Brasil\",\n     x = \"\\n칈ndice de desarrollo humano\",\n     y = \"\\nPorcentaje por grupo\\n\\n\") \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot <- ggplot(HDI, aes(group_hdi, share, fill = group_hdi)) +\n   geom_col() +\n   geom_hline(yintercept = 0) +\n   geom_text(\n     aes(y = y_text, label = label, color = group_hdi),\n     size = 4.5\n   ) +\n   coord_flip() +\n   scale_x_discrete(labels = x_labels) +\n   scale_fill_brewer(palette = \"YlGnBu\") +\n   scale_color_manual(values = c(rep(\"black\", 5), \n                                 rep(\"white\", 2), \n                                 \"black\")) +\n   guides(fill = \"none\", color = \"none\") +\n   labs(\n     title = \"\\n칈ndice de Desarrollo Humano\\nS칚o Paulo, Brasil\\n\",\n     caption = \"Poblaci칩n total: 11.209.673 hab.\\nDatos: Atlas Brasil\",\n     x = \"\\n칈ndice de desarrollo humano\",\n     y = \"\\nPorcentaje por grupo\\n\\n\") +\n  theme(\n    text = element_text(family = \"fira\"),\n    panel.grid = element_blank(),\n    plot.title = element_text(size = 25, colour = \"gray20\", face=\"bold\"),\n    axis.text.y = element_text(size = 13, colour = \"gray20\"),\n    axis.title.x = element_text(size = 18, colour = \"gray20\"),\n    axis.title.y = element_text(size = 18, colour = \"gray20\"),\n    axis.text.x = element_blank(),\n    panel.background = element_rect(fill = 'white', color = 'white')\n  )\n\n#plot\n```\n:::\n\n\n\n![](bar1.png)\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}