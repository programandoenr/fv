---
execute:
  message: false
  warning: false
  fig-show: no
title: "Percentage of Russian speakers in Ukraine ðŸ‡ºðŸ‡¦"
author: "FV"
date: "2023-01-11"
categories: [code, analysis, map]
image: "img.png"
---

Working with the libraries: "sf", "stringr", "dplyr", "ggplot2" and "ggthemes".

```{r}
# lIB

{
library('sf')
library("ggplot2")
library("dplyr")
library("stringr")
}

ru <- read_sf('ruso/Ruso_Parlantes_Ucrania.shp')

ru <- ru %>% 
  st_as_sf()

A <- ggplot(data = ru) +
  ggtitle("Ð£ÐºÑ€Ð°Ñ—Ð½Ð° - Ð’Ñ–Ð´ÑÐ¾Ñ‚Ð¾Ðº Ñ€Ð¾ÑÑ–Ð¹ÑÑŒÐºÐ¾Ð¼Ð¾Ð²Ð½Ð¸Ñ…") +
  xlab("") +
  ylab("") +
  geom_sf(aes(fill=PorcRus), show.legend = T, size = 0.05) +
  scale_fill_viridis_c(alpha = .6) +
  geom_sf_text(aes(label =Ucraniano),size=3,family="sans")+
  theme(plot.title = element_text(size = 16),
        plot.subtitle = element_text(size = 20)) +
  labs(fill= "Ð’Ñ–Ð´ÑÐ¾Ñ‚Ð¾Ðº")

A

library("ggspatial")

ru$EspaÃ±ol <- gsub("Ciudad de Kiev","Kiev ",ru$EspaÃ±ol)
ru$EspaÃ±ol <- gsub("RepÃºblica AutÃ³noma de Crimea","Crimea",ru$EspaÃ±ol)

es <- ggplot(data = ru) +
  ggtitle("Percentage of Russian speakers in Ukraine") +
  xlab("") +
  ylab("") +
  geom_sf(aes(fill=PorcRus), show.legend = T, size = 0.05) +
  scale_fill_viridis_c(alpha = .6, direction = -1) +
  geom_sf_text(aes(label =EspaÃ±ol),size=3,family="sans")+
  theme(plot.title = element_text(size = 20, face = "bold"),
        plot.subtitle = element_text(size = 20),
        legend.position="bottom") +
  labs(fill= "%") +
  annotation_scale()

es 
```

Shapefile layers 2019 Data: gov.uk
